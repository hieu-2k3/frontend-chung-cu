<!-- Contracts Management Modal -->
<div id="contracts-modal" class="modal hidden">
    <div class="modal-content glass-panel modal-lg">
        <span class="close-modal" id="close-contracts-modal">&times;</span>
        <div class="modal-header">
            <h2><i class="fa-solid fa-file-contract"></i> Quản Lý Hợp Đồng Thuê</h2>
            <button class="btn-primary" onclick="openCreateContractModal()"
                style="width: auto; padding: 0.6rem 1.5rem;">
                <i class="fa-solid fa-plus"></i> Tạo Hợp Đồng Mới
            </button>
        </div>
        <div class="modal-body">
            <!-- Filter -->
            <div style="margin-bottom: 1.5rem; display: flex; gap: 1rem; align-items: center;">
                <select id="contract-filter"
                    style="padding: 0.5rem 1rem; border-radius: 0.5rem; background: rgba(0,0,0,0.3); color: white; border: 1px solid rgba(255,255,255,0.1);">
                    <option value="all">Tất cả</option>
                    <option value="active">Đang hoạt động</option>
                    <option value="expiring">Sắp hết hạn (30 ngày)</option>
                    <option value="expired">Đã hết hạn</option>
                </select>
                <div id="contract-stats" style="color: var(--text-secondary); font-size: 0.9rem;">
                    <span id="active-contracts-count">0</span> đang hoạt động |
                    <span id="expiring-contracts-count" style="color: #fbbf24;">0</span> sắp hết hạn
                </div>
            </div>

            <!-- Contracts Table -->
            <div class="all-residents-scroll-area">
                <table class="residents-table">
                    <thead>
                        <tr>
                            <th>Phòng</th>
                            <th>Khách thuê</th>
                            <th>SĐT</th>
                            <th>Bắt đầu</th>
                            <th>Kết thúc</th>
                            <th>Tiền cọc</th>
                            <th>Trạng thái</th>
                            <th>Thao tác</th>
                        </tr>
                    </thead>
                    <tbody id="contracts-list">
                        <tr>
                            <td colspan="8" style="text-align:center; padding:2rem;">Đang tải...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Create/Edit Contract Modal -->
<div id="create-contract-modal" class="modal hidden">
    <div class="modal-content glass-panel" style="max-width: 650px; max-height: 90vh; overflow-y: auto;">
        <span class="close-modal" id="close-create-contract-modal">&times;</span>
        <div class="modal-header">
            <h2><i class="fa-solid fa-file-signature"></i> <span id="contract-form-title">Tạo Hợp Đồng Mới</span></h2>
        </div>
        <div class="modal-body">
            <form id="contract-form" class="premium-form">
                <input type="hidden" id="contract-id" value="">

                <!-- Room Selection -->
                <div class="form-group">
                    <label>Phòng <span style="color: #ef4444;">*</span></label>
                    <select id="contract-room" required>
                        <option value="">-- Chọn phòng --</option>
                    </select>
                </div>

                <!-- Tenant Info -->
                <h3
                    style="color: var(--accent-blue); font-size: 1.1rem; margin: 1.5rem 0 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid rgba(255,255,255,0.1);">
                    <i class="fa-solid fa-user"></i> Thông tin khách thuê
                </h3>

                <div class="form-group">
                    <label>Họ và tên <span style="color: #ef4444;">*</span></label>
                    <input type="text" id="contract-tenant-name" placeholder="Nguyễn Văn A" required>
                </div>

                <div class="form-grid-2">
                    <div class="form-group">
                        <label>Số điện thoại <span style="color: #ef4444;">*</span></label>
                        <input type="tel" id="contract-tenant-phone" placeholder="0912345678" required>
                    </div>
                    <div class="form-group">
                        <label>CMND/CCCD</label>
                        <input type="text" id="contract-tenant-id" placeholder="001234567890">
                    </div>
                </div>

                <!-- Financial Info -->
                <h3
                    style="color: var(--accent-green); font-size: 1.1rem; margin: 1.5rem 0 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid rgba(255,255,255,0.1);">
                    <i class="fa-solid fa-money-bill-wave"></i> Thông tin tài chính
                </h3>

                <div class="form-grid-2">
                    <div class="form-group">
                        <label>Tiền thuê/tháng (đ) <span style="color: #ef4444;">*</span></label>
                        <input type="number" id="contract-monthly-rent" placeholder="5000000" required>
                    </div>
                    <div class="form-group">
                        <label>Tiền cọc (đ) <span style="color: #ef4444;">*</span></label>
                        <input type="number" id="contract-deposit" placeholder="10000000" required>
                    </div>
                </div>

                <div class="form-group">
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                        <input type="checkbox" id="contract-deposit-paid" style="width: auto;">
                        <span>Đã nhận tiền cọc</span>
                    </label>
                </div>

                <!-- Contract Duration -->
                <h3
                    style="color: var(--accent-amber); font-size: 1.1rem; margin: 1.5rem 0 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid rgba(255,255,255,0.1);">
                    <i class="fa-solid fa-calendar-days"></i> Thời hạn hợp đồng
                </h3>

                <div class="form-grid-2">
                    <div class="form-group">
                        <label>Ngày bắt đầu <span style="color: #ef4444;">*</span></label>
                        <input type="date" id="contract-start-date" required>
                    </div>
                    <div class="form-group">
                        <label>Thời hạn (tháng) <span style="color: #ef4444;">*</span></label>
                        <input type="number" id="contract-duration" placeholder="12" min="1" required>
                    </div>
                </div>

                <div class="form-group">
                    <label>Ngày kết thúc (tự động tính)</label>
                    <input type="date" id="contract-end-date" readonly
                        style="background: rgba(0,0,0,0.3); cursor: not-allowed;">
                </div>

                <!-- Terms -->
                <h3
                    style="color: var(--text-secondary); font-size: 1.1rem; margin: 1.5rem 0 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid rgba(255,255,255,0.1);">
                    <i class="fa-solid fa-list-check"></i> Điều khoản đặc biệt
                </h3>

                <div id="contract-terms-list" style="margin-bottom: 1rem;">
                    <!-- Terms will be added here -->
                </div>

                <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                    <input type="text" id="new-term-input" placeholder="Nhập điều khoản mới..." style="flex: 1;">
                    <button type="button" class="btn-primary" onclick="addContractTerm()"
                        style="width: auto; padding: 0.5rem 1rem;">
                        <i class="fa-solid fa-plus"></i> Thêm
                    </button>
                </div>

                <!-- Submit -->
                <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                    <button type="button" class="btn-secondary" onclick="closeCreateContractModal()" style="flex: 1;">
                        Hủy
                    </button>
                    <button type="submit" class="btn-primary" style="flex: 1;">
                        <i class="fa-solid fa-save"></i> Lưu Hợp Đồng
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Contract Detail Modal -->
<div id="contract-detail-modal" class="modal hidden">
    <div class="modal-content glass-panel" style="max-width: 600px;">
        <span class="close-modal" id="close-contract-detail-modal">&times;</span>
        <div class="modal-header">
            <h2><i class="fa-solid fa-file-lines"></i> Chi Tiết Hợp Đồng</h2>
        </div>
        <div class="modal-body" id="contract-detail-content">
            <!-- Content will be loaded dynamically -->
        </div>
    </div>
</div>